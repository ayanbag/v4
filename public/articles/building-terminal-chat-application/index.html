<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="map[name:Ayan Bag]">
<meta name="description" content="It is better to have a conversation
In our daily life we encounter with many chat application which a really awesome. It takes a lot effort to develop and maintain these application because it involves a two way communication between different user and logging each and every request provide by server.
Getting inspired by the chat application as we see in Die Hard 4, I created my own realtime chat application ." />
<meta name="keywords" content="Ayan Bag, ayan bag, ayanbag, @ayanbag, ayanbag9474,UX/UI Designer Kalyani Government Engineering College, KGEC, kgec,Kalyani, IEEE, Backend Developer, Data Science, Deep Learning, TCS,TCS Engnix, Hackoctober 2019,Hackoctober 2018, Github,Kolkata,Kalyani, Delhi, India,Electronics and Communication, Computer Science and Engineering, Computer Science, IEEE-KGEC, medium, python, development" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#252627" />
<link rel="canonical" href="https://example.com/articles/building-terminal-chat-application/" />

<link rel="icon" type="image/png" sizes="32x32" href="icon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="icon/favicon-16x16.png">




    <title>
        
            Building Termina Chat Application with Python and Pusher :: Ayan Bag 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://example.com/main.min.7bfbbe12786fa0ded4b4c0d792cbb36a5bd0bdb0b856dde57aa7b1f6fe0f2b87.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://example.com/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://example.com/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://example.com/images/favicon-16x16.png">
    <link rel="manifest" href="https://example.com/images/site.webmanifest">
    <link rel="mask-icon" href="https://example.com/safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="https://example.com/images/favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="#252627">

<meta itemprop="name" content="Building Termina Chat Application with Python and Pusher">
<meta itemprop="description" content="It is better to have a conversation
In our daily life we encounter with many chat application which a really awesome. It takes a lot effort to develop and maintain these application because it involves a two way communication between different user and logging each and every request provide by server.
Getting inspired by the chat application as we see in Die Hard 4, I created my own realtime chat application .">
<meta itemprop="datePublished" content="2018-10-23T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2018-10-23T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1603">



<meta itemprop="keywords" content="medium,python,development," /><meta property="og:title" content="Building Termina Chat Application with Python and Pusher" />
<meta property="og:description" content="It is better to have a conversation
In our daily life we encounter with many chat application which a really awesome. It takes a lot effort to develop and maintain these application because it involves a two way communication between different user and logging each and every request provide by server.
Getting inspired by the chat application as we see in Die Hard 4, I created my own realtime chat application ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.com/articles/building-terminal-chat-application/" />
<meta property="article:published_time" content="2018-10-23T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-10-23T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Building Termina Chat Application with Python and Pusher"/>
<meta name="twitter:description" content="It is better to have a conversation
In our daily life we encounter with many chat application which a really awesome. It takes a lot effort to develop and maintain these application because it involves a two way communication between different user and logging each and every request provide by server.
Getting inspired by the chat application as we see in Die Hard 4, I created my own realtime chat application ."/>



    <meta property="article:section" content="tutorials" />



    <meta property="article:published_time" content="2018-10-23 00:00:00 &#43;0000 UTC" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://example.com/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ ayanbag@home</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://example.com/about">About</a></li><li><a href="https://example.com/articles">Articles</a></li><li><a href="https://drive.google.com/file/d/1y4vAPFJH6rIj0kykn0-dBaMYJR1DenVu/view">Resume</a></li>
    </ul>
</nav>


                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://example.com/articles/building-terminal-chat-application/">Building Termina Chat Application with Python and Pusher</a></h2>

            

            <div class="post-content">
                <p>It is better to have a conversation</p>
<p>In our daily life we encounter with many chat application which a really awesome. It takes a lot effort to develop and maintain these application because it involves a two way communication between different user and logging each and every request provide by server.</p>
<p>Getting inspired by the chat application as we see in Die Hard 4, I created my own realtime chat application . And I am here to share how I made this interactive real-time chat application with quite concise Python code.It also feature an in-app file transfer system.So, lets get started.</p>
<h3 id="prerequisites">Prerequisites</h3>
<p>Basic knowledge and understanding of python and its related concepts. Also need Python 3.x and pip installed and configured in your machine.</p>
<h3 id="setting-up-your-app">Setting up your app:</h3>
<p>I build the server with the help of a third party dependency , Pusher. Pusher is a hosted service that make super easy to add real-time data and functionality to web, console and mobile application.</p>
<p><strong>Step 1:</strong> Create a account in pusher.com. I personally prefer to go with free account , if you use this project as a hobby project. In your free account , you will get <em>a daily message sending limit of 200,000</em> which will be enough for testing and using this chat app.</p>
<p><strong>Step 2:</strong> After creating a the account, navigate to your dashboard.</p>
<p><img src="https://cdn-images-1.medium.com/max/2698/1*mKNvvH9LHrTofPS1AwTPzw.png" alt="Your dashboard will look like this."><em>Your dashboard will look like this.</em></p>
<p>After you navigate to your dashboard , click the **Create New App **button.</p>
<p><strong>Step 3:</strong> Now fill the required information i.e your application name , cluster info ( it is a physical location of server to handle your request ), your tech stack(front-end and back-end) and something about your app.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*jho000oMW7YJCFQg92vqFw.png" alt=""></p>
<p>Then hit the Create My App button.</p>
<p><strong>Step 4:</strong> After that, a another dashboard will appear. Here navigate to App Key column and take a note of all *the app credential *(app_id,key,secret,cluster).</p>
<h3 id="creating-our-chat-application"><strong>Creating our chat application</strong></h3>
<p><strong>Initial Stage:</strong></p>
<p>Firstly, it is preferred to create a isolated python environment for our app.It can be achieved by installing the package virtualenv. It is used to manage different environments in Python. This is so we do not end up with conflicting libraries which is different from project to projects.To install virtualenv , we have to run :</p>
<pre><code>sudo pip install virtualenv
</code></pre>
<p>for windows, (run in cmd or Powershell as admin)</p>
<pre><code>pip install virtualenv
</code></pre>
<p>Next, we need to create a virtual environment for our app</p>
<pre><code>virtualenv terminal_chat
</code></pre>
<p>Now we are done with setting up the environment,we move to the new directory created and the activate the enviroment.</p>
<pre><code>#Changing the directory
cd terminal_chat
#activating the enviroment
source bin/activate
</code></pre>
<p>for windows user,</p>
<pre><code>#changing the directory
cd terminal_chat
#activating the eniviroment
Scripts\activate
</code></pre>
<p>Now we need to install the following libraries which are required in our project.</p>
<ul>
<li>
<p>PyInquirer : A collection of common interactive command line user interfaces.</p>
</li>
<li>
<p>termcolor : ANSII Color formating for printing color text in output terminal.</p>
</li>
<li>
<p>progress : A animation package to create animated progression bar in terminal.</p>
</li>
<li>
<p>pusher : The official Python library for interacting with the Pusher HTTP API.</p>
</li>
<li>
<p>pysher : Python module for handling pusher WebSockets. This will handle event subscriptions using Pusher</p>
</li>
<li>
<p>python-dotenv : Python module that reads the key, value pair from .env file and adds them to the environment variable.</p>
</li>
<li>
<p>sql.connector : Allows Python to communicate with MySQL database.</p>
</li>
</ul>
<p>To install, we need to run</p>
<pre><code>pip install termcolor pusher
pip install git+https://github.com/nlsdfnbch/Pysher.git 
pip install python-dotenv PyInquirer progress
pip install mysql-connector
</code></pre>
<p><strong>Creating a entry point for our app:</strong></p>
<p>Now, we need to create .env file which holds our environmental variable which connect our app with Pusher. Create .env file in your working directory.</p>
<pre><code>app_id=your_api_id
app_key=your_app_key
app_secret=your_app_secret
app_cluster=your_app_cluster
</code></pre>
<p><strong>Creating User Login and Registration System:</strong></p>
<p>Now create user login and registration authorization system named login_auth.py and add:</p>
<!-- raw HTML omitted -->
<p>Before you run the script create a database named **user_info **and this database create a table named userwith columns:</p>
<ul>
<li>
<p>used_id : a unique id for each user</p>
</li>
<li>
<p>name : stores the name of each user</p>
</li>
<li>
<p>username : stores the username</p>
</li>
<li>
<p>passwod : stores the password</p>
</li>
</ul>
<p>You can create the database in Structured Query Language or in MySQL Workbench.</p>
<blockquote>
<h1 id="if-you-dont-know-structure-query-languagesql-then-go-for-mysql-workbench-it-provides-gui-based-environment-for-creating-a-database-without-any-knowledge-of-sql"><strong>If you donâ€™t know Structure Query Language(SQL) then go for MySQL Workbench, it provides GUI based environment for creating a database without any knowledge of SQL.</strong></h1>
</blockquote>
<p><strong>Creating Chatroom Database:</strong></p>
<p>After you create user login system, its time to setup the chatroom for our users.Now , create a file named chatrooms_server.py and add:</p>
<!-- raw HTML omitted -->
<p>Again before you run this script, create a table named user under same database user_info with columns</p>
<ul>
<li>
<p>server_rooms : stores all registered chatroom</p>
</li>
<li>
<p>id : unused variable in the program but still required</p>
</li>
</ul>
<p><strong>Creating the File Transfer System :</strong></p>
<p>Now we will setup our FTP to transfer file in-app.Here, in my app I used DriveHQ FTP Service (Free Version).Only you have to sign up in <a href="https://www.drivehq.com">www.drivehq.com</a> as free service user.You can use any FTP Service you want.</p>
<pre><code>**Cloud FTP Server Details of DriveHQ**:(for free user)
FTP SERVER NAME: ftp.drivehq.com
IP ADDRESS : 66.220.9.50
</code></pre>
<p>Now create a script called ftpserver.py and add:</p>
<!-- raw HTML omitted -->
<p>Above code, is used to upload the file provided by user in cloud and to download the file requested by user.</p>
<p>Here, ftplib is a File Transfer Protocol module that implements the client side of the FTP protocol.</p>
<p><strong>Creating the main app and its UI:</strong></p>
<p>Now create a file called terminalchat.py and add:</p>
<!-- raw HTML omitted -->
<p>Let explain you what is happening in the above code.</p>
<p>We import termcolor to print color text, PyInquirer to print formatted menu in the console, progress to do animation in our console and finally load_env to load environment variables from .env file.</p>
<p>Here, we also imported ftpserver.py and user_login_reg.py so that we can use the functionality of those script in our terminalchat.py script.</p>
<p>The TerminalChat class then defined, with some properties</p>
<ul>
<li>
<p>pusher : this property will hold the Pusher server instance once it is available.</p>
</li>
<li>
<p>channel: this property will hold the Pusher instance of the channel subscribed to.</p>
</li>
<li>
<p>clientPusher: this property will hold the Pusher client instance once it is available.</p>
</li>
<li>
<p>user: this property will hold the details of the currently logged in user.</p>
</li>
<li>
<p>users: this property holds a static list of users who can log in, with their values as the password. In a real-world application, this would usually be gotten from some database</p>
</li>
<li>
<p>chatrooms: this property holds a list of all available chat-rooms one can join.</p>
</li>
</ul>
<p>Now let describe you the defined functions in terminalchat.py :</p>
<ul>
<li>
<p>main : This a entry point into our script. Here,we call welcome function , the login function and the chat selector function.After that, we have a while loop with getInput function so the function will be always running and we will always have a input to type new message to the terminal.</p>
</li>
<li>
<p>logincred : It is a login function. In this function we request username and password from user and calls login_auth_reg.login() function for authorizing the login.</p>
</li>
<li>
<p>chatselector: It also the user to create or enter into a specific chatroom. It will check whether the input chatroom exists or not. If it exists , the call initPusher , which initialized and setup Pusher to send and receive our message</p>
</li>
<li>
<p>getInput : It shows an input with the logged in userâ€™s name in front, waiting for the user to enter a message and send</p>
</li>
</ul>
<p><strong>NOTE</strong>: In terminalchat.py is have used os.system(&lsquo;cls&rsquo;) as my development environment is Windows. If you running this script in Linux, replace os.system(&lsquo;cls&rsquo;) to os.system(&lsquo;clear&rsquo;) .</p>
<p><strong>Connecting to the Pusher server:</strong></p>
<p>Now we will connect the server to our client i.e our chat app. So to implement that we need import the following packages in terminalchat.py .</p>
<!-- raw HTML omitted -->
<p>After this add this segment of code in terminalchat.py :</p>
<!-- raw HTML omitted -->
<p>In initPusher function, we initialize a Pusher instance to a variable named pusher , passing in our app_id ,app_key, app_secret and app_cluster . After that we initialize a new Pysher client for Pusher. Here we Pysher as client library for Pusher because default library of Pusher only allows triggering of event and not subscribing them. We bind to the connection , the pusher:connection_established is pass to connectHandler function as its callback.After that, we call connect on clientPusher .</p>
<p>In connectHandler , we receive an argument as data , which comprise of connection data that comes from established connection between Pusher WebSockets. We subscribe to the channel, which has been chosen with Pusher, then bind to an event called newmessage, passing in the pusherCallback function as itâ€™s callback.</p>
<p>In the pusherCallback method, we receive an argument called message, which returns the object of the new message received from Pusher. Here, we convert the message to a readable JSON format for Python, then check if the message isn&rsquo;t for the currently logged in user before printing the message to the screen alongside the senderâ€™s name. We also print the logged in userâ€™s name to the screen, with a colon in its front, so the user knows he can still type.</p>
<p>Now this segement of code at the end of getInput function of TerminalChat class:</p>
<pre><code>self.pusher.trigger(self.chatroom, u'newmessage', {&quot;user&quot;: self.user, &quot;message&quot;: message})
</code></pre>
<p>After receiving a message, we trigger a newmessage event to current chat-room,which pass the current user and message sent.</p>
<h2 id="putting-all-pieces-of-code-into-one-file">Putting all pieces of Code into one file</h2>
<p>Here is what our terminalChat.py looks like:</p>
<!-- raw HTML omitted -->
<h2 id="demo">Demo</h2>
<p>The demo of our Terminal Chat App :</p>
<!-- raw HTML omitted -->
<p>Finally, thanks for bearing with me and reading till the last character! I applaud your patience ðŸ™‚.</p>
<p>Ref. : <a href="https://www.pusher.com/tutorials">https://www.pusher.com/</a></p>
<p>P.S: For my other projects, check my <a href="https://github.com/ayanbag">GitHub</a> Profile.</p>
<hr>
<h2 id="author">Author</h2>
<blockquote>
<p>Hey, Iâ€™m Ayan, a backend software engineer. I write about what I know to help viewers like you. please consider supporting what I do!</p>
<p><a href="https://ko-fi.com/B0B81M1SZ"><img src="https://www.ko-fi.com/img/githubbutton_sm.svg" alt="ko-fi"></a></p>
</blockquote>

            </div>
        </article>

        <hr />

        <div class="post-info">
  				<p>
  					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://example.com/tags/medium">medium</a></span><span class="tag"><a href="https://example.com/tags/python">python</a></span><span class="tag"><a href="https://example.com/tags/development">development</a></span>
  				</p>
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="https://example.com">Ayan Bag</a></span>
            
            <span><a href='https://mailchi.mp/4bdabcbbc62d/subs'>Subscribe</a></span>
            <span> <a href="https://example.com/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Support Me on <a href='https://ko-fi.com/B0B81M1SZ'>Ko-fi</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="https://example.com/bundle.min.2d5469329143160ae2456a69c3c76dc2d0a3b212b46afe291a51bd68650ed6f8697e001dab54f1c272c77ce08092a8c55e5bb4314e0ee334aab4b927ec896638.js" integrity="sha512-LVRpMpFDFgriRWppw8dtwtCjshK0av4pGlG9aGUO1vhpfgAdq1TxwnLHfOCAkqjFXlu0MU4O4zSqtLkn7IlmOA=="></script>



    </body>
</html>
